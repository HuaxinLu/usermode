.\" Copyright (C) 1997,1999 Red Hat Software, Inc.
.\"
.\" This is free software; you can redistribute it and/or modify it
.\" under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This program is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program; if not, write to the Free Software
.\" Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
.\"
.TH USERHELPER 8 "19 March 1999" "Red Hat Software"
.SH NAME
userhelper \- A helper interface to pam.
.SH SYNOPSIS
.B userhelper
[\ -t\ ] [\ -w\ prog\ args\ ] [\ -c\ ] [\ \-f\ full-name\ ] [\ \-o\ office\ ] [\ \-p\ office-phone\ ] [\ \-h\ home-phone\ ] [\ \-s\ shell\ ] [\ username \]

.SH DESCRIPTION
NOTE this program is NOT intended to be run interactively.  If you
want to change this information on the command line use
.IR passwd (1),
.IR chfn (1), 
or
.IR chsh (1).
.PP
This program provides a basic interface to change a user's password, gecos
information, and shell.  The main differnce between this program and
its traditional equivilents is that prompts come out on standard out
to make it easy for a GUI program to interface it as a child process.
.PP
The output is in the form of:
.TP
<number> <string>
.PP
Where the number is the type of prompt returned from pamlib, and the
string is the prompt to give the user.
.PP
The prompt numbers are as follows:
.TP
1
Prompt with visible input.
.TP
2
Prompt with invisible input.
.TP
3
Informational message.
.TP
4
Error message.
.TP
5
Count of messages sent in this block so far.
.SH OPTIONS
.TP
.I -t
Text mode authentication instead of the numbered message types
just described; only used with -w.
.TP
.I -w
Specify a program name and arguments to be passed through.  userhelper
will look up in the file /etc/security/console.apps/\fIprogramname\fP
the username to authenticate stored as USER=\fIvalue\fP (\fIvalue\fP
is normally "root" or the magic token "<user>" which indicates
to authenticate the current user) and the program to run stored as
PROGRAM=\fIvalue\fP (\fIvalue\fP \fBmust\fP be an absolute path or it
will be ignored).  If USER is not specified, the current user is used,
and if PROGRAM is not specified, userhelper looks for \fIprogramname\fP
in /sbin and /usr/sbin/.  userhelper will then authenticate the user via
pam and then run the named program.  If SESSION=true is specified, then
userhelper establishes a pam session and forks and execs, then waits
around for the child to exit; otherwise, it simply execs the child.
userhelper is normally called from consolehelper via a symlink.
If FALLBACK=true is specified, the program will run as user if
authentication fails.  Authentication will be retried twice (three
times total) unless something other than RETRY=2 is specified.
.TP
.I -c 
Change the current user's password.  Note that this option cannot be
used with any of the other options.  This is due to the limitation in
the interface to pamlib.
.TP
.I -f
Specify a new Full Name.
.TP
.I -o
Specify a new Office.
.TP
.I -p
Specify a new Office Phone.
.TP
.I -h
Specify a new Home Phone.
.TP
.I -s
Specify a new shell.
.SH EXIT STATUS
A non-zero exit status indicates an error occured.  Those errors are:
.TP
1
The authentication passwords was incorrect.
.TP
2
One or more of the GECOS fields is invalid.  This occurs when there is
a colon supplied in one of the fields.
.TP
3
Password resetting error.
.TP
4
Some system files are locked.
.TP
5
User unknown.
.TP
6
Insufficent rights.
.TP
7
Invalid call to this program.
.TP
8
The shell provided is not valid (i.e., does not exist in /etc/shells).
.TP
9
Ran out of memory.
.TP
10
Could not find the program.
.TP
11
exec failed even though program exists.
.TP
255
Unknown error.
.SH FILES
.TP 25
.I /etc/passwd
The gecos and shell information is stored in this file.
.TP 25
.I /etc/shells
This file is checked to see if the new shell supplied is valid.
.SH "SEE ALSO"
.IR userpasswd (1),
.IR userinfo (1),
.IR consolehelper (8),
.IR chfn (1),
.IR chsh (1),
.IR passwd (5)
.SH AUTHOR
Otto Hammersmith <otto@redhat.com>
.br
Michael K. Johnson <johnsonm@redhat.com>
